--Drop tables
Drop TABLE fine;
Drop TABLE borrow_return;
Drop TABLE student;
Drop TABLE book;

--Create tables
CREATE TABLE student
(
    student_id NUMBER(5) GENERATED BY DEFAULT ON NULL AS IDENTITY START WITH 1 PRIMARY KEY,
    stu_name VARCHAR2(20) NOT NULL,
    stu_gender VARCHAR2(10) NOT NULL,
    stu_address VARCHAR2(200) NOT NULL,
    stu_classYear NUMBER(2) NOT NULL
    
);

CREATE TABLE book
(
    book_id NUMBER(5) GENERATED BY DEFAULT ON NULL AS IDENTITY START WITH 1 PRIMARY KEY,
    book_title VARCHAR2(200) NOT NULL,
    book_author VARCHAR2(100) NOT NULL,
    book_category VARCHAR2(50)  NOT NULL,
    publication_year NUMBER(5),
    book_status NUMBER(2) NOT NULL

);

CREATE TABLE borrow_return
(
    borrow_id NUMBER(5)  NOT NULL,
    student_id NUMBER(5) NOT NULL,
    book_id NUMBER(5) NOT NULL,
    borrow_date DATE,
    due_date DATE,
    return_date  DATE,
    PRIMARY KEY(borrow_id),
    CONSTRAINT fk_br_stuId FOREIGN KEY (student_id) REFERENCES student(student_id),
    CONSTRAINT fk_br_bookId FOREIGN KEY (book_id) REFERENCES book(book_id)
);
create index index_borrowReturn_book_id on borrow_return(book_id);
create index index_borrowReturn_student_id on borrow_return(student_id);

CREATE TABLE fine
(
    fine_id NUMBER(5)   GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    borrow_id NUMBER(5) NOT NULL,
    overdue_days NUMBER(5),
    fine_amount NUMBER(10),
    CONSTRAINT fk_fine_borrowId FOREIGN KEY (borrow_id) REFERENCES borrow_return(borrow_id)
);